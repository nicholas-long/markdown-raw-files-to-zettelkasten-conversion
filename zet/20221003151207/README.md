# windows privilege escalation
- check for local ports
- `whoami /all` vulnerable privs - exploits can enable if disabled
    - SeImpersonatePrivilege
    - SeManageVolumePrivilege
    - SeRestorePrivilege
    SeAssignPrimaryPrivilege, SeTcbPrivilege, SeBackupPrivilege, SeCreateTokenPrivilege, SeLoadDriverPrivilege, SeTakeOwnershipPrivilege, SeDebugPrivilege
- https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation
- permissions
  - applications that run as SYSTEM
  - write permissions
- list services
  - unquoted service paths
  - writable executable
  - modify service
  - restart services by restarting machine
  - registry modification permissions
- systeminfo
- enum users and groups
- service account with low privileges -> recover default privileges
- horizontal escalation - service users may have privileges
- website
  - check code, creds, config, secrets
  - writable webroot -> webshell, web server user
- common general enumeration stuff
  - enumerate installed applications and configs 
    - hunt for creds ( appdata, lazagne )
    - web browsers -> https://github.com/djhohnstein/SharpWeb
    - saved RDP and and credential manager
    - saved SSH keys on filesystem and in regsitry
    - IIS web configs
    - hacktricks "Possible filenames containing credentials"
- user data
  - clipboard
  - powershell history
  - credentials manager ( cmdkey )
  - appdata
    - browser data - dump with tools like SharpChromium
    - sticky notes
    - sqlite3 databases
    - specific applications - investigate each
- running processes
  - dump memory with procdump from sysinternals
- headline exploits from privesc to try list
- enum tools to run
  - winpeas
  - watson
  - powerview checks?
- writable path
- dll injection
- always install elevated
- unattended XML
- active user session ->
  - clipboard
  - screenshot / meterpreter screenshare
- restart perms run at startup with different user
- vulnerable printer drivers
  - users can install vulnerable drivers by adding a printer type
- migrate to interactive process
- check hotfixes
- wdigest ( plain text pass in registry )
- SAM & SYSTEM backups
- check perms of WSL directories
- check applocker policy
- pop up login box with powershell
- recycle bin
- WSUS - using http instead of https
- McAfee SiteList.xml
- SCCM SCClient
- domain stuff - to try list for foothold has info about domains
  - [AD to try list](./to-try-list.md#active directory domain)
- https://wadcoms.github.io/# 
- on LAN
  - responder netbios LLMNR name poisoning
  - mitm6
  - relay attacks: impacket ntlmrelayx / smbrelay
- check exploits / vulnerabilities found during enumeration
  - leaked credentials
  - potential privesc exploits
  - vulnerable services running as SYSTEM
- java web -> find website code packaged into war file
  - secrets, config, hardcoded creds
- no access to read webroot -> try appending known filenames to path to read

` zet/20221003151207/README.md `

# Related

- [20221014185602](/zet/20221014185602/README.md) kb file named kb/hacking/to-try-lists/privesc/windows.md
- [20221014181941](/zet/20221014181941/README.md) general privilege escalation
- [20221003151172](/zet/20221003151172/README.md) active directory domain to try list
- [20221003151144](/zet/20221003151144/README.md) active directory 
- [20221003151137](/zet/20221003151137/README.md) active directory  sensitive files
- [20221003150473](/zet/20221003150473/README.md) powershell tricks run powershell commands as another user with RunasCs
- [20221003151106](/zet/20221003151106/README.md) compile windows DLL to run commands
- [20221013190422](/zet/20221013190422/README.md) headline exploits
- [20221013185837](/zet/20221013185837/README.md) HKCU registry hive ntuser.dat
- [20221013174958](/zet/20221013174958/README.md) concept of persistence on a target
- [20221003150445](/zet/20221003150445/README.md) linpeas winpeas peass-ng release downloads
- [20221003150426](/zet/20221003150426/README.md) zip slip evilarc.py
- [20221003150366](/zet/20221003150366/README.md) convert DLL to shellcode with sRDI
- [20221003150365](/zet/20221003150365/README.md) windows fully interactive pty with ConPtyShell
- [20221003151056](/zet/20221003151056/README.md) get enumeration info from file read about level of patches installed on windows
- [20221003151055](/zet/20221003151055/README.md) get windows verison info from file read
- [20221003151053](/zet/20221003151053/README.md) lsass process contains credentials
- [20221003151165](/zet/20221003151165/README.md) TFTP udp 69
- [20221003151221](/zet/20221003151221/README.md) pypykatz dump hashes from registry backup
- [20221003151203](/zet/20221003151203/README.md) LDAP
- [20221003151059](/zet/20221003151059/README.md) locations where authenticated users can write in windows
- [20221003151201](/zet/20221003151201/README.md) RDP
- [20221003151200](/zet/20221003151200/README.md) got read or write access to filesystem
- [20221003150439](/zet/20221003150439/README.md) Scanning a system for credentials
- [20221003151060](/zet/20221003151060/README.md) location of services in windows registry
- [20221011182016](/zet/20221011182016/README.md) working notes - privesc
- [20221009192000](/zet/20221009192000/README.md) stuff to put on main page
- [20221010064819](/zet/20221010064819/README.md) locating the origin of files by hash to determine version
- [20221009102436](/zet/20221009102436/README.md) hacking to try lists
- [20221009005402](/zet/20221009005402/README.md) preparing for the OSCP exam
- [20221008215655](/zet/20221008215655/README.md) user account
- [20221008191607](/zet/20221008191607/README.md) procmon auto scroll
- [20221007220451](/zet/20221007220451/README.md) hacking notes hub
- [20221003151206](/zet/20221003151206/README.md) windows privilege escalation headline exploits
- [20221003151205](/zet/20221003151205/README.md) windows privilege escalation AD headline exploits
- ~/kb/hacking/to-try-lists/privesc/windows.md

Tags:

    #to-try-list #hacking #privesc #windows #windows 
